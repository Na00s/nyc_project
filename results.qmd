# Results

```{r}

nyc_weekly_earnings <- read.csv("nyc_weekly_earnings.csv")

for (col in c("Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov"
              , "Dec", "Annual")) {
  nyc_weekly_earnings[[col]] <- as.numeric(gsub("[\\$,]", "", nyc_weekly_earnings[[col]]))
}

nyc_weekly_earnings <- subset(nyc_weekly_earnings, Year >= 2013)

nyc_weekly_earnings <- nyc_weekly_earnings %>% select(-Annual)

national_weekly_earnings <- read.csv("Average weekly earnings of all employees, total private, seasonally adjusted-national.csv")

```

```{r}

library(ggplot2)
library(tidyr)

nyc_weekly_earnings <- pivot_longer(nyc_weekly_earnings, cols = -Year, names_to = "Month", values_to = "Value")
national_weekly_earnings <- pivot_longer(national_weekly_earnings, cols = -Year, names_to = "Month", values_to = "Value")

nyc_weekly_earnings$Location <- "New York City"

national_weekly_earnings$Location <- "National"

weekly_earnings <- rbind(nyc_weekly_earnings, national_weekly_earnings)

weekly_earnings$Date <- as.Date(paste(weekly_earnings$Year, weekly_earnings$Month, "01", sep = "-"), format = "%Y-%b-%d")

ggplot(weekly_earnings, aes(x = Date, y = Value, color = Location)) +
  geom_line() +
  labs(title = "NYC vs. National Average Weekly Income Over Time",
       x = "Date",
       y = "Average Weekly Income ($)")+
  theme_linedraw()+
  scale_x_date(date_breaks = "2 year", date_labels = "%b %Y")+
  scale_y_continuous(breaks = seq(800, 1450, by = 50))+
  theme(plot.title = element_text(hjust = 0.5))

```

```{r}
library(dplyr)

weekly_earnings <- weekly_earnings %>%
  mutate(PercentChange = c(((Value - lag(Value)) / lag(Value)) * 100))

subsampled_df <- weekly_earnings %>% slice(seq(1, n(), by = 2))


ggplot(subsampled_df, aes(x = Date, y = PercentChange, color = Location)) +
  geom_line() +
  labs(title = "Percent Change in NYC vs. National Average Weekly Income Over Time",
       x = "Date",
       y = "Percent Change in Average Weekly Income (%)")+
  theme_linedraw()+
  scale_x_date(date_breaks = "2 year", date_labels = "%b %Y")+
  theme(plot.title = element_text(hjust = 0.5))
```

```{r}

nyc_weekly_earnings$Difference <- nyc_weekly_earnings$Value - national_weekly_earnings$Value

nyc_weekly_earnings$Date <- as.Date(paste(nyc_weekly_earnings$Year, nyc_weekly_earnings$Month, "01", sep = "-"), format = "%Y-%b-%d")

ggplot(nyc_weekly_earnings, aes(x = Date, y = Difference)) +
  geom_line() +
  labs(title = "Difference Between NYC and National Average Weekly Earnings Over Time",
       x = "Date",
       y = "Average Weekly Income ($)")+
  theme_linedraw()+
  scale_x_date(date_breaks = "2 year", date_labels = "%b %Y")+
  theme(plot.title = element_text(hjust = 0.5))

```

*Weekly hours next (might not include hourly earnings because could be redundant). Then I'll do a parallel coordinate plot for the different sectors and their employment rates. Also don't need to include all three of these graphs, I just thought it was interesting to dive further into depth what was happening. Will also want to do probably just a simple unemployment rate one.*


